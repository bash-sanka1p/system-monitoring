# References :
# https://raw.githubusercontent.com/grafana/loki/refs/heads/main/production/docker/config/loki.yaml
# https://raw.githubusercontent.com/grafana/loki/refs/heads/main/cmd/loki/loki-docker-config.yaml
# https://grafana.com/docs/loki/latest/get-started/components/

auth_enabled: false

server:
  # http_listen_address: 0.0.0.0
  # grpc_listen_address: 0.0.0.0

  http_listen_port: 3100
  grpc_listen_port: 9095
  log_level: info

common:
  # instance_addr: 0.0.0.0
  compactor_address: http://loki-backend:3100
  path_prefix: /loki
  replication_factor: 1
  ring: #This is how loki discovers peers;
    kvstore:
      # store: inmemory # inmemory wont be shared accorss containers and will cause failure in SSD method
      store: memberlist # Configured below


# storage_config:
#   filesystem:
#     chunks_directory: /loki/chunks
#     rules_directory: /loki/rules

# Configuring memberlist
memberlist:
  join_members: ["loki-read", "loki-write", "loki-backend"]
  bind_addr: ['0.0.0.0']
  bind_port: 7946
  gossip_interval: 2s


# compactor:
#   compactor_grpc_address: loki-backend:3100

# query_range:
#   results_cache:
#     cache:
#       embedded_cache:
#         enabled: true
#         max_size_mb: 100

# limits_config:
#   metric_aggregation_enabled: true
#   enable_multi_variant_queries: true

schema_config:
  configs:
    - from: 2020-10-24
      store: tsdb
      object_store: filesystem
      schema: v13
      index:
        prefix: index_
        period: 24h

# pattern_ingester:
#   enabled: true
#   metric_aggregation:
#     # loki_address: localhost:3100
#     loki_address: loki-write:3100

# ruler:
#   alertmanager_url: http://localhost:9093

# frontend:
#   encoding: protobuf

analytics:
  reporting_enabled: false
